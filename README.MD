# Domonap Home Assistant Integration

![Logo](https://github.com/svmironov/domonap_intercom/blob/main/img/icon.png?raw=true)

Интеграция позволяет управлять устройствами, привязанными к приложению **Domonap** (альтернативный провайдер домофона в домах ПИК) из **Home Assistant**.

## Возможности

* Открытие дверей  
* Загрузка видеопотока  
* Уведомления о звонках в виде бинарного сенсора  
* События в фоновом процессе для использования в автоматизациях  

## Автоматизации

Интеграция генерирует событие `domonap_incoming_call` при входящем звонке, которое можно использовать в автоматизациях Home Assistant. Событие содержит следующие данные:
* `DoorId` - идентификатор двери
* `Address` - адрес вызывающего устройства 
* `PhotoUrl` - URL фотографии звонящего
* Другие данные из уведомления

Пример автоматизации:
```yaml
automation:
  - alias: "Уведомление о звонке"
    trigger:
      platform: event
      event_type: domonap_incoming_call
    action:
      - service: notify.mobile_app
        data:
          message: "Входящий звонок на домофон"
          data:
            image: "{{ trigger.event.data.photoUrl }}"
```

## Ограничения

* Существует ограничение на одновременное использование одного номера телефона на нескольких устройствах  
* По неизвестной причине сервер может завершать сессии — для возобновления работы интеграции необходимо выполнить авторизацию заново  

## Установка

* Установите **HACS**  
* Добавьте репозиторий [https://github.com/svmironov/domonap_intercom](https://github.com/svmironov/domonap_intercom) в **HACS**  
* Найдите **Domonap** в списке интеграций  
* Нажмите **Установить**  
* Перезапустите сервер **Home Assistant**  
* После перезапуска добавьте интеграцию в разделе **Настройки → Устройства и службы**  
* Авторизация выполняется по номеру телефона, привязанному к приложению при регистрации  

## Отказ от ответственности

Данное программное обеспечение никак не связано и не одобрено ООО «ДОМОНАП», владельцем торговой марки **ДОМОНАП**. Используйте его на свой страх и риск. Автор ни при каких обстоятельствах не несёт ответственности за повреждение или утрату вашего имущества, а также за возможный вред третьим лицам.  

Все названия брендов и продуктов принадлежат их законным владельцам.