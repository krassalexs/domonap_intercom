# Domonap Home Assistant Integration

![Logo](https://github.com/svmironov/domonap_intercom/blob/main/img/icon.png?raw=true)

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–º–∏ –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é Domonap (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä –¥–æ–º–æ—Ñ–æ–Ω–∞ –≤ –¥–æ–º–∞—Ö –ü–ò–ö) –∏–∑ Home Assistant

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

* –û—Ç–∫—Ä—ã—Ç–∏–µ –¥–≤–µ—Ä–µ–π
* –ó–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–∞
* –ü–æ–ª—É—á–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –≤—Ö–æ–¥—è—â–∏—Ö –∑–≤–æ–Ω–∫–∞—Ö
* –ü–æ–ª—É—á–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏–∑ —á–∞—Ç–∞ –¥–æ–º–æ—Ñ–æ–Ω–∞

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

* –°—É—â–µ—Å—Ç–≤—É–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –æ–¥–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
* ~~–ù–∞ —Ç–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç –Ω–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–≤–æ–Ω–∫–∞—Ö~~
* ~~–ü–æ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–π –ø—Ä–∏—á–∏–Ω–µ —Å–µ—Ä–≤–µ—Ä –º–æ–∂–µ—Ç —É–±–∏–≤–∞—Ç—å —Å–µ—Å—Å–∏–∏, –¥–ª—è –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –∑–∞–Ω–æ–≤–æ~~  

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

* –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ HACS
* –î–æ–±–∞–≤—å—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π https://github.com/svmironov/domonap_intercom –≤ HACS 
* –ù–∞–π–¥–∏—Ç–µ Domonap –≤ –ø–æ–∏—Å–∫–µ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è–º
* –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–∞–∂–∞–≤ –Ω–∞ –∫–Ω–æ–ø–∫—É "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å" 
* –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä Home Assistant
* –ü–æ—Å–ª–µ –¥–æ–±–∞–≤—å—Ç–µ –∏—Ç–µ–≥—Ä–∞—Ü–∏—é –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –≤ –ø—É–Ω–∫—Ç–µ "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ –°–ª—É–∂–±—ã"
* –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω–æ–º—É –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

## –ü–æ–ª—É—á–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏—Å–ø—É—Å–∫–∞–µ—Ç —Å–∏–≥–Ω–∞–ª—ã –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –≤ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏:
1. ```domonap_incoming_call``` —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è:
```yaml
event_type: domonap_incoming_call
data:
  EventMessage: DomofonCalling
  DoorId: 8452d508564e5a076c8122b6
  Address: –õ–∏—Ñ—Ç–æ–≤–æ–π —Ö–æ–ª–ª
  CallId: "154543486.54786447"
  VideoUrl: https://hls.domonap.ru/8452d508564e5a076c8122b6/index.m3u8
  HttpVideoUrl: https://hls.domonap.ru/8452d508564e5a076c8122b6/index.m3u8
  VideoPreview: >-
    https://api.domonap.ru/video-api/preview/Device/8452d508564e5a076c8122b6/qQtfsMiQYS0YuD8LLKrDGbPijncAShubrISKMs7E1cw
  SipAccount: "1000457231"
  SipPassword: 8452d508564e5a076c8122b6
  SipDomain: asterisk-2.domonap.ru
  SipPort: "7021"
  PushType: Domofon
  photoUrl: https://s3-api.domonap.ru/snapshot/154543486.54786447
origin: LOCAL
time_fired: "2025-06-18T15:10:58.919425+00:00"
```

2. ```domonap_receive_message``` —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è:
```yaml
event_type: domonap_receive_message
data:
  id: 8452d508564e5a076c8122b6
  channel: username1-username
  text: "–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è"
  data: null
  sender: username1
  name: Username
  chatType: Private
  createdOn: "2025-06-18T15:02:32.1264693Z"
  isRead: false
  avatar: https://s3-api.domonap.ru/avatar/avatar
origin: LOCAL
time_fired: "2025-06-18T15:02:32.208782+00:00"
```

3. ```domonap_user_status_changed``` —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è:
```yaml
event_type: domonap_user_status_changed
data:
  user: username1
  status: offline
origin: LOCAL
time_fired: "2025-06-18T15:07:23.395167+00:00"
```

–ü—Ä–∏–º–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–≤–æ–Ω–∫–µ –≤ Telegram (–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ [Telegram](https://www.home-assistant.io/integrations/telegram_polling)):
```yaml
alias: –ó–≤–æ–Ω–æ–∫ –∏–∑ –¥–æ–º–æ—Ñ–æ–Ω–∞ –≤ Telegram
description: ""
mode: single
triggers:
  - trigger: event
    event_type: domonap_incoming_call
    enabled: true
conditions: []
actions:
  - action: telegram_bot.send_photo
    data:
      caption: |-
        üìûüì≤ –ö—Ç–æ-—Ç–æ –∑–≤–æ–Ω–∏—Ç –≤ –¥–æ–º–æ—Ñ–æ–Ω
        üìç {{ trigger.event.data.Address }}
      url: "{{ trigger.event.data.photoUrl }}"
      inline_keyboard: "üîì –û—Ç–∫—Ä—ã—Ç—å:/open_{{ trigger.event.data.DoorId }}"
```

## –û—Ç–∫–∞–∑ –æ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

–î–∞–Ω–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –Ω–∏–∫–∞–∫ –Ω–µ —Å–≤—è–∑–∞–Ω–æ –∏ –Ω–µ –æ–¥–æ–±—Ä–µ–Ω–æ –û–û–û –î–û–ú–û–ù–ê–ü, –≤–ª–∞–¥–µ–ª—å—Ü–∞ —Ç–æ—Ä–≥–æ–≤–æ–π –º–∞—Ä–∫–∏ –î–û–ú–û–ù–ê–ü. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –Ω–∞ —Å–≤–æ–π —Å—Ç—Ä–∞—Ö –∏ —Ä–∏—Å–∫. –ê–≤—Ç–æ—Ä –Ω–∏ –ø—Ä–∏ –∫–∞–∫–∏—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö –Ω–µ –Ω–µ—Å—ë—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ –ø–æ—Ä—á—É –∏–ª–∏ —É—Ç—Ä–∞—Ç—É –≤–∞—à–µ–≥–æ –∏–º—É—â–µ—Å—Ç–≤–∞ –∏ –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ –≤—Ä–µ–¥–∞ –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏–∏ —Ç—Ä–µ—Ç—å–∏—Ö –ª–∏—Ü.

–í—Å–µ –Ω–∞–∑–≤–∞–Ω–∏—è –±—Ä–µ–Ω–¥–æ–≤ –∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç –∏—Ö –∑–∞–∫–æ–Ω–Ω—ã–º –≤–ª–∞–¥–µ–ª—å—Ü–∞–º.
